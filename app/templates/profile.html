<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í–æ–ª–æ–Ω—Ç–µ—Ä–ü–∞—Ä–∫</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
        integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/login.css">
</head>

<body>
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
    <div class="profile-page" id="profilePage">
        <nav class="navbar navbar-expand-lg navbar-dark" style="background: #2d5016;">
            <div class="container">
                <a class="navbar-brand" href="/">üåø –í–æ–ª–æ–Ω—Ç–µ—Ä–ü–∞—Ä–∫</a>
                <div class="navbar-nav ml-auto">
                    <a class="btn btn-outline-light btn-sm" href="/">
                        ‚Üê –ù–∞–∑–∞–¥
                    </a>
                </div>
            </div>
        </nav>

        <div class="container mt-4">
            <div class="row">
                <div class="col-12">
                    <div class="profile-header text-center mb-5">
                        <div class="profile-avatar" style="font-size: 80px; margin-bottom: 15px">üëë</div>
                        <h2 style="color: #1d1b1b;">{{ first_name }} {{ last_name }}</h2>
                        <p class="text-muted">{{ login }}</p>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-12">
                    <div class="stats-card">
                        <h4 style="color: #112b00; margin-bottom: 20px;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h4>
                        <div class="stat-item">
                            <span>–£—á–∞—Å—Ç–∏–π –≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö:</span>
                            <strong class="stat-value">0</strong>
                        </div>
                        <div class="stat-item">
                            <span>–í—Å–µ–≥–æ —á–∞—Å–æ–≤ –≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–∞:</span>
                            <strong class="stat-value">0</strong>
                        </div>
                        <div class="stat-item">
                            <span>–í–æ–ª–æ–Ω—Ç–µ—Ä —Å:</span>
                            <strong class="stat-value">–¥–µ–∫–∞–±—Ä—å 2025</strong>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 mb-4">
                    <div class="stats-card">
                        <h4 style="color: #2d5016; margin-bottom: 20px;">üéÅ –ú–æ–∏ –±–æ–Ω—É—Å—ã</h4>

                        <div class="bonus-stats-grid">
                            <!-- –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ –±–æ–Ω—É—Å—ã -->
                            <div class="bonus-stat-card">
                                <div class="bonus-stat-header">
                                    <div class="bonus-stat-icon">üöá</div>
                                    <div class="bonus-stat-info">
                                        <div class="bonus-stat-title">–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</div>
                                        <div class="bonus-stat-count">0 –∏–∑ 5</div>
                                    </div>
                                </div>
                                <div class="bonus-progress">
                                    <div class="progress-bar" style="width: 0%"></div>
                                </div>
                                <div class="bonus-stat-desc">–î–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ –Ω–∞ 1 –¥–µ–Ω—å</div>
                            </div>

                            <!-- –ù–µ–º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–µ –±–æ–Ω—É—Å—ã -->
                            <div class="bonus-stat-card">
                                <div class="bonus-stat-header">
                                    <div class="bonus-stat-icon">‚≠ê</div>
                                    <div class="bonus-stat-info">
                                        <div class="bonus-stat-title">–ü—Ä–∏–≤–∏–ª–µ–≥–∏–∏</div>
                                        <div class="bonus-stat-count">0/10</div>
                                    </div>
                                </div>
                                <div class="bonus-progress">
                                    <div class="progress-bar" style="width: 0%"></div>
                                </div>
                                <div class="bonus-stat-desc">–î–æ –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞ –º–µ—Å—è—Ü–∞</div>
                            </div>

                            <!-- –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –±–æ–Ω—É—Å—ã -->
                            <div class="bonus-stat-card">
                                <div class="bonus-stat-header">
                                    <div class="bonus-stat-icon">üèõÔ∏è</div>
                                    <div class="bonus-stat-info">
                                        <div class="bonus-stat-title">–ì–æ—Ä–æ–¥—Å–∫–∏–µ</div>
                                        <div class="bonus-stat-count">0 –¥–æ—Å—Ç—É–ø–Ω–æ</div>
                                    </div>
                                </div>
                                <div class="bonus-stat-available">
                                </div>
                                <div class="bonus-stat-desc">–ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã</div>
                            </div>

                            <!-- –†–∏—Ç–µ–π–ª –±–æ–Ω—É—Å—ã -->
                            <div class="bonus-stat-card">
                                <div class="bonus-stat-header">
                                    <div class="bonus-stat-icon">üõçÔ∏è</div>
                                    <div class="bonus-stat-info">
                                        <div class="bonus-stat-title">–ú–∞–≥–∞–∑–∏–Ω—ã</div>
                                        <div class="bonus-stat-count">0 —Å–∫–∏–¥–æ–∫</div>
                                    </div>
                                </div>
                                <div class="bonus-stat-available">
                                </div>
                                <div class="bonus-stat-desc">–î–µ–π—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</div>
                            </div>
                        </div>

                        <!-- –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –±–æ–Ω—É—Å–æ–≤ -->
                        <div class="bonus-details mt-4">
                            <h6 style="color: #2d5016; margin-bottom: 15px;">üìã –ê–∫—Ç–∏–≤–Ω—ã–µ –±–æ–Ω—É—Å—ã</h6>
                            <div class="bonus-details-list">
                                <p style="color: #616161;">–í—ã –µ—â–µ –Ω–µ –ø–æ–ª—É—á–∞–ª–∏ –±–æ–Ω—É—Å—ã</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 mb-4">
                    <div class="stats-card">
                        <h4 style="color: #2d5016; margin-bottom: 20px;">–ú–æ–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h4>
                        <p style="color: #616161;">–í—ã –µ—â–µ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–ª–∏ —É—á–∞—Å—Ç–∏–µ –≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let map;
        let placemarks = [];

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function showLoginPage() {
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('mapPage').style.display = 'none';
            document.getElementById('profilePage').style.display = 'none';
        }

        function showMapPage() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mapPage').style.display = 'block';
            document.getElementById('profilePage').style.display = 'none';
            setTimeout(initMap, 100);
        }

        function showProfilePage() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mapPage').style.display = 'none';
            document.getElementById('profilePage').style.display = 'block';
            closeMenu();
        }

        function showParksPage() {
            alert('–°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ü–∞—Ä–∫–∏" —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–∞');
            closeMenu();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        function showMessage(text) {
            alert(text);
        }

        // –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—é
        function joinEvent(eventId) {
            alert('üéâ –í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ!');
        }

        // –§–æ–∫—É—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–∏
        function focusOnEvent(eventId) {
            const eventData = getEventData(eventId);
            if (eventData && placemarks[eventId]) {
                map.setCenter([eventData.coords[0], eventData.coords[1]], 16);
                placemarks[eventId].balloon.open();
                document.querySelectorAll('.event-card').forEach(card => card.classList.remove('active'));
                document.getElementById(`card-${eventId}`).classList.add('active');
            }
        }

        // –î–∞–Ω–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
        function getEventData(eventId) {
            const events = {
                'gorky': {
                    coords: [55.728955, 37.603579],
                    title: '–£–±–æ—Ä–∫–∞ –≤ –ü–∞—Ä–∫–µ –ì–æ—Ä—å–∫–æ–≥–æ',
                    time: '–ó–∞–≤—Ç—Ä–∞, 10:00-13:00',
                    address: '–ö—Ä—ã–º—Å–∫–∏–π –í–∞–ª, 9',
                    description: '–°–±–æ—Ä —É –≥–ª–∞–≤–Ω–æ–≥–æ –≤—Ö–æ–¥–∞. –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è. –û–±–µ–¥ –≤–∫–ª—é—á–µ–Ω.'
                },
                'neskuchny': {
                    coords: [55.709683, 37.597258],
                    title: '–£–±–æ—Ä–∫–∞ –≤ –ù–µ—Å–∫—É—á–Ω–æ–º —Å–∞–¥—É',
                    time: '15 –¥–µ–∫–∞–±—Ä—è, 14:00-17:00',
                    address: '–õ–µ–Ω–∏–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç, 20',
                    description: '–£–±–æ—Ä–∫–∞ –æ–ø–∞–≤—à–µ–π –ª–∏—Å—Ç–≤—ã –∏ –º—É—Å–æ—Ä–∞. –†–∞–±–æ—Ç–∞ –≤ –Ω–µ–±–æ–ª—å—à–∏—Ö –≥—Ä—É–ø–ø–∞—Ö.'
                },
                'sokolniki': {
                    coords: [55.791348, 37.677933],
                    title: '–£–±–æ—Ä–∫–∞ –≤ –°–æ–∫–æ–ª—å–Ω–∏–∫–∞—Ö',
                    time: '20 –¥–µ–∫–∞–±—Ä—è, 11:00-14:00',
                    address: '–°–æ–∫–æ–ª—å–Ω–∏—á–µ—Å–∫–∏–π –í–∞–ª, 1',
                    description: '–†–∞—Å—á–∏—Å—Ç–∫–∞ –¥–æ—Ä–æ–∂–µ–∫ –æ—Ç —Å–Ω–µ–≥–∞ –∏ —É–±–æ—Ä–∫–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏. –¢–µ–ø–ª—ã–π —á–∞–π –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω.'
                },
                'izmaily': {
                    coords: [55.787152, 37.771609],
                    title: '–ü—Ä–µ–¥–Ω–æ–≤–æ–≥–æ–¥–Ω—è—è —É–±–æ—Ä–∫–∞ –≤ –ò–∑–º–∞–π–ª–æ–≤–æ',
                    time: '25 –¥–µ–∫–∞–±—Ä—è, 12:00-15:00',
                    address: '–ù–∞—Ä–æ–¥–Ω—ã–π –ø—Ä–æ—Å–ø–µ–∫—Ç, 17',
                    description: '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–∞—Ä–∫–∞ –∫ –ù–æ–≤–æ–º—É –≥–æ–¥—É. –£–∫—Ä–∞—à–µ–Ω–∏–µ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏.'
                }
            };
            return events[eventId];
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
        function initMap() {
            if (typeof ymaps === 'undefined') {
                document.getElementById('map').innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; background: #e1e5ec; color: #666; text-align: center; padding: 20px;">
                        <div>
                            <h4>–ö–∞—Ä—Ç–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</h4>
                            <p>–ó–¥–µ—Å—å –±—É–¥–µ—Ç –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç–∞ —Å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º–∏</p>
                        </div>
                    </div>
                `;
                return;
            }

            ymaps.ready(function () {
                map = new ymaps.Map('map', {
                    center: [55.7558, 37.6173],
                    zoom: 11,
                    controls: ['zoomControl', 'fullscreenControl']
                });

                const eventIds = ['gorky', 'neskuchny', 'sokolniki', 'izmaily'];

                eventIds.forEach(eventId => {
                    const eventData = getEventData(eventId);
                    if (eventData) {
                        const placemark = new ymaps.Placemark(
                            eventData.coords,
                            {
                                balloonContentHeader: `<div class="balloon-title">${eventData.title}</div>`,
                                balloonContentBody: `
                                    <div class="balloon-time">${eventData.time}</div>
                                    <div>üìç ${eventData.address}</div>
                                    <div style="margin-top: 10px;">${eventData.description}</div>
                                    <button onclick="joinEvent('${eventId}')" style="margin-top: 10px; background: #8bc34a; color: white; border: none; padding: 8px 15px; border-radius: 15px; cursor: pointer;">
                                        –ó–∞–ø–∏—Å–∞—Ç—å—Å—è
                                    </button>
                                `,
                                hintContent: eventData.title
                            },
                            {
                                preset: 'islands#greenIcon',
                                balloonCloseButton: true,
                                hideIconOnBalloonOpen: false
                            }
                        );

                        placemark.events.add('click', function () {
                            document.querySelectorAll('.event-card').forEach(card => card.classList.remove('active'));
                            document.getElementById(`card-${eventId}`).classList.add('active');
                        });

                        map.geoObjects.add(placemark);
                        placemarks[eventId] = placemark;
                    }
                });
            });
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–µ–Ω—é
        function toggleMenu() {
            const sidebar = document.getElementById('sidebar');
            const menuButton = document.getElementById('menuButton');
            sidebar.classList.toggle('active');
            menuButton.classList.toggle('active');
        }

        function closeMenu() {
            const sidebar = document.getElementById('sidebar');
            const menuButton = document.getElementById('menuButton');
            sidebar.classList.remove('active');
            menuButton.classList.remove('active');
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –≤—Ö–æ–¥–∞
        document.getElementById('loginForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const email = this.querySelector('input[type="email"]').value;
            const password = this.querySelector('input[type="password"]').value;

            if (email && password) {
                showMapPage();
            } else {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function () {
            showLoginPage();

            const menuButton = document.getElementById('menuButton');
            const sidebar = document.getElementById('sidebar');

            if (menuButton && sidebar) {
                menuButton.addEventListener('click', function (e) {
                    e.stopPropagation();
                    toggleMenu();
                });

                document.addEventListener('click', function (e) {
                    if (sidebar.classList.contains('active') &&
                        !sidebar.contains(e.target) &&
                        !menuButton.contains(e.target)) {
                        closeMenu();
                    }
                });
            }
        });
    </script>
</body>

</html>